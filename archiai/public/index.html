<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="it"&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;ArchiAI - Assistente per Architetti&lt;/title&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/* ... (il tuo CSS rimane invariato) ... */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;header&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;h1&gt;ArchiAI - Assistente per Architetti&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/header&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="chat-container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="chat-messages" id="chat-messages"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="message ai-message"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>Benvenuto! Sono ArchiAI, il tuo assistente per trovare prodotti per i tuoi progetti architettonici. Come posso aiutarti oggi?</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="chat-input"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="text" id="user-input" placeholder="Descrivi i prodotti che stai cercando..."&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="send-button"&gt;Invia&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.addEventListener('DOMContentLoaded', function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const chatMessages = document.getElementById('chat-messages');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const userInput = document.getElementById('user-input');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const sendButton = document.getElementById('send-button');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function sendMessage() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const message = userInput.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (message !== '') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const userMessageDiv = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>userMessageDiv.className = 'message user-message';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>userMessageDiv.textContent = message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>chatMessages.appendChild(userMessageDiv);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>userInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>chatMessages.scrollTop = chatMessages.scrollHeight;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const aiMessageDiv = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>aiMessageDiv.className = 'message ai-message';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>aiMessageDiv.textContent = "Sto elaborando la tua richiesta...";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>chatMessages.appendChild(aiMessageDiv);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>chatMessages.scrollTop = chatMessages.scrollHeight;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>fetch('/api/query', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>method: 'POST',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>headers: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>'Content-Type': 'application/json',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>body: JSON.stringify({ query: message }),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>.then(response =&gt; response.json())</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>.then(data =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Rimuovi il messaggio "Sto elaborando..."</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>chatMessages.removeChild(chatMessages.lastChild);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const aiResponseDiv = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>aiResponseDiv.className = 'message ai-message';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>aiResponseDiv.innerHTML = data.response; // Usa innerHTML per supportare HTML formattato</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>chatMessages.appendChild(aiResponseDiv);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>if (data.products &amp;&amp; data.products.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>const productsGrid = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>productsGrid.className = 'products-grid';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>data.products.forEach(product =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>const productCard = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>productCard.className = 'product-card';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>productCard.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;img src="${product.immagini[0]}" alt="${product.nome}" class="product-image"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;div class="product-info"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;div class="product-name"&gt;${product.nome}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;div class="product-price"&gt;€${product.prezzo}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>productsGrid.appendChild(productCard);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>chatMessages.appendChild(productsGrid);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>chatMessages.scrollTop = chatMessages.scrollHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>.catch(error =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>console.error('Errore:', error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>chatMessages.lastChild.textContent = "Errore durante l'elaborazione della richiesta.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>sendButton.addEventListener('click', sendMessage);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>userInput.addEventListener('keypress', function(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (e.key === 'Enter') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>sendMessage();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
